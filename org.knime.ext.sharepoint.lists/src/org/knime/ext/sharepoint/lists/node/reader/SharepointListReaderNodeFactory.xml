<?xml version="1.0" encoding="utf-8"?>
<knimeNode icon="./sharepoint-list-icon.png" type="Source"
	xmlns="http://knime.org/node/v4.1"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://knime.org/node/v4.1 http://knime.org/node/v4.1.xsd">
	<name>SharePoint Online List Reader</name>

	<shortDescription>
		Read a SharePoint Online list.
	</shortDescription>

	<fullDescription>
		<intro>
			<p>
				This node reads a SharePoint Online list and outputs it as a KNIME table.
				You can select to which KNIME types the SharePoint Online list column types
				should be transformed.
			</p>
			<u>Supported column types</u>
			<p>
				Currently, most major column types are fully or partly supported by this node.
			</p>
			<p>
				<i>Single line of text</i>, <i>Choice</i>, <i>Number</i>, <i>Yes/No</i> and
				<i>Date and time</i> columns have <b>full support.</b>
			</p>
			<p>
				The following column types are <b>supported with some drawbacks</b>
				<ul>
					<li><i>Multiple lines of text</i> columns do not clean rich text if this feature is enabled. That means the HTML tags have to be removed manually if this is desired</li>
					<li><i>Calculated</i> columns are always Strings</li>
					<li><i>Currency</i> columns are always Doubles. Thus the currency information is not displayed and must be obtained using other means</li>
					<li><i>Person</i> columns return a row ID in the "User Information List" (see below)</li>
					<li><i>Lookup</i> columns return a row ID in linked list (see below). This linked list is not exposed and must be obtained using other means</li>
				</ul>
			</p>
			<p>
			The following column types are currently <b>unsupported</b>: <i>Location</i>, <i>Hyperlink</i>, <i>Image</i>, <i>Task Outcome</i>, <i>External Data</i> and <i>Managed Metadata</i> The node will
				output the JSON it received for them as a String. You can
				select to transform it into the JSON type in the "Transformation"
				tab if you have the KNIME JSON extension installed.
				Any column types this node cannot recognize will also output the raw JSON data.
			</p>
			<p>
				<i>Image</i> columns are encoded as a JSON string containing JSON so you have to unpack that first.
			</p>
			<u>Working with Person and Lookup columns</u>
			<p>
				<i>Person</i> and <i>Lookup</i> columns display data from other SharePoint Online lists.
				Instead of containing the value in the other list they store the value of the "ID" column of the row in that list.
				To be able to access the content you must join that other list
				using a <a href="https://kni.me/n/WzkQfvBXnYxub9hJ">Joiner node</a>
				and another <i>SharePoint Online List Reader</i> to join using the "ID" column.
			</p>
			<p>
				If you are dealing with a <i>Lookup</i> column, you can get the name of the column you are trying to join
				from the settings of the <i>Lookup</i> column (which can for example be found in the old web interface). The name
				of any additional columns that are looked up can be found in the table specification as names of those columns.
			</p>
			<p>
				<i>Person</i> columns obtain their data from the so called "User Information List"
				(with the internal name "users") which is a hidden system list in the Root of a SharePoint
				site. To see it, you have to check "Show system lists". The name may be localized to
				your language so you should search for the internal name.
			</p>
			<u>Generated Columns</u>
			<p>
				Apart from the columns you define in a SharePoint Online list there are some which are always present in your list.
				There is currently no way of distinguishing them from the
			columns you defined. This is because View information cannot be read.
			This also means that the order of the columns in a View may not be
			the same. SharePoint also generates columns for some
			specific column types such as <i>Location</i> columns. If you do not
			want to use these columns or want another order, you have to deselect and reorder them in the
			"Transformation" tab.
			</p>
		</intro>
		<tab name="Settings">
			<option name="SharePoint site">
				There are three ways to specify SharePoint site:
				<ul>
					<li>
						<i>Root site:</i>Connect to the root site of the domain of the current user (see "Microsoft Connection" input port).
					</li>
					<li>
						<i>Web URL:</i>Specify the web URL of a SharePoint site, for example <i>https://mycompany.sharepoint.com</i>.
					</li>
					<li>
						<i>Group site:</i> Connect to the team site of a particular Office 365 group.
					</li>
				</ul>
			</option>
			<option name="Subsite">
				If checked, then connect to a (nested) subsite of the SharePoint site specified above. Use the "Refresh" button to list all available subsites
				of the chosen SharePoint site. Note that this allows you only to access the document libraries of the subsite, not those of the parent site(s).
			</option>
			<option name="SharePoint list">
				Here you can select the list you want to read. The drop down menu shows the display name of the list and the internal name it in parentheses.
			</option>
			<option name="Show system lists">
				If checked, the drop down will also contain hidden system lists.
			This option has to be checked if you want to access the "User Information List".
			</option>
		</tab>
		<tab name="Transformation">
			<option name="Transformations">
				This tab displays every column as a row in a table that allows modifying the structure of the output table.
				It supports reordering, filtering and renaming columns. It is also possible to change the type of the columns.
				Reordering is done via drag-and-drop. Just drag a column to the position it should have in the output table.
				Note that the positions of columns are reset in the dialog if a new file or folder is selected.
				Whether and where to add unknown columns during execution is specified via the special row &lt;any unknown new column&gt;.
				It is also possible to select the type, new columns should be converted to.
				Note that the node will fail if this conversion is not possible e.g. if the selected type is Integer but the new column is of type Double.
			</option>
			<option name="Reset order">Resets the order of columns to the order in the input file/folder.</option>
			<option name="Reset filter">Clicking this button will reset the filters i.e. all columns will be included.</option>
			<option name="Reset names">Resets the names to the names that are read from file or created if the file/folder doesn't contain column names.</option>
			<option name="Reset types">Resets the output types to the default types guessed from the input file/folder.</option>
			<option name="Reset all">Resets all transformations.</option>
			<option name="Enforce types">
				Controls how columns whose type changes are dealt with. If selected, we attempt to map to the KNIME type you
				configured and fail if that's not possible.
				If unchecked, the KNIME type corresponding to the new type is used.
			</option>
		</tab>
		<tab name="Advanced">
			<option name="Connection timeout in seconds">
				Timeout in seconds to establish a connection or 0 for an infinite timeout.
			</option>
			<option name="Read timeout in seconds">
				Timeout in seconds to read data from an established connection or 0 for an infinite timeout.
			</option>
		</tab>
		<tab name="Limit Rows">
			<option name="Skip first data rows">
			  If enabled, the specified number of valid data rows are skipped. This has no effect on which row will be
			  chosen as a column header.
			</option>
			<option name="Limit data rows">
			  If enabled, only the specified number of data rows are read. The column header row (if selected) is
			  not taken into account.
			</option>
		</tab>
	</fullDescription>
	<ports>
		<inPort index="0" name="Microsoft Connection">
			Microsoft Connection that provides user authentication.
		</inPort>
		<outPort index="0" name="Table">
			Read SharePoint list in a table
		</outPort>
	</ports>
</knimeNode>

