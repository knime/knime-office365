<?xml version="1.0" encoding="utf-8"?>
<knimeNode icon="./sharepoint-list-writer.png" type="Sink"
    xmlns="http://knime.org/node/v4.1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://knime.org/node/v4.1 http://knime.org/node/v4.1.xsd">
    <name>SharePoint Online List Writer</name>

	<shortDescription>
		Writes a SharePoint Online list.
	</shortDescription>

	<fullDescription>
		<intro>
			<p>
				This node writes data from KNIME to a SharePoint list.
			</p>
			<b>SharePoint Online list column type support</b>
			<b>All column types which are not mentioned below are partially supported and will get written with their String representation to a Text column in SharePoint</b>
			<u>Fully supported column types:</u>
                <ul>
                    <li><i>String columns map to Multiple lines of text</i></li>
                    <li><i>Long, Integer columns map to Number</i></li>
                    <li><i>Boolean columns map to Yes/No</i></li>
                    <li><i>Date, Date and Time, Zoned Date Time map to Date and time</i></li>
                </ul>
                <u>Partially supported columns types:</u>
                <ul>
					<li>
						<i>Double columns map to Number but they are only partially supported in terms of range
							SharePoint is able to store double values. Number
							columns can only have 5 decimal places and the
							range is from 1.79E308 to -1.79E308 (for values above or below the node will fail). 
							It also does not support infinity and NaN (the node will fail).
						</i>
					</li>
                </ul>
                <u>Unsupported column types (will be ignored during execution):</u><br/>
                <ul>
                    <li><i>Collection columns are not supported since there is no counterpart type in SharePoint</i></li>
                    <li><i>Binary object columns</i> are not supported since there is no counterpart type in SharePoint</li>
                    <li><i>Image columns</i> are not supported since the Graph API does not support this type currently.</li>
                </ul>
		</intro>
        <tab name="Settings">
            <option name="SharePoint site">
                There are three ways to specify SharePoint site:
                <ul>
                    <li>
                        <i>Root site:</i>Connect to the root site of the domain of the current user (see "Microsoft Connection" input port).
                    </li>
                    <li>
                        <i>Web URL:</i>Specify the web URL of a SharePoint site, for example <i>https://mycompany.sharepoint.com</i>.
                    </li>
                    <li>
                        <i>Group site:</i> Connect to the team site of a particular Office 365 group.
                    </li>
                </ul>
            </option>
            <option name="Subsite">
                If checked, then connect to a (nested) subsite of the SharePoint site specified above. Use the "Refresh" button to list all available subsites
                of the chosen SharePoint site. Note that this allows you only to access the document libraries of the subsite, not those of the parent site(s).
            </option>
            <option name="SharePoint list">
                Here you can select the list you want to overwrite or you can enter the name of a new list you want to create. The drop down menu shows the display name of the list and the internal name it in parentheses.
                Note that if you create a new list (by entering a name manually) the node can not save a list ID and on reexecution the node will search for the ID by the list name.
                In case you changed the list name in SharePoint the node will not be able to find the list. If you reopen the dialog and save it again the ID will be saved in the settings.
            </option>
            <option name="Overwrite policy if list exists">
                <ul>
                    <li>
                        <i>Overwrite</i> if the list already exists it will get overwritten or a new list will be created.
                    </li>
                    <li>
                        <i>Fail</i> if the list already exists.
                    </li>
                </ul>
            </option>
        </tab>
        <tab name="Advanced">
            <option name="Connection timeout in seconds">
                Timeout in seconds to establish a connection or 0 for an infinite timeout.
            </option>
            <option name="Read timeout in seconds">
                Timeout in seconds to read data from an established connection or 0 for an infinite timeout.
            </option>
        </tab>

	</fullDescription>
	<ports>
		<inPort index="0" name="Microsoft Connection">
			Microsoft Connection that provides user authentication.
		</inPort>
		<inPort index="1" name="Table">
			The table to be written to SharePoint.
		</inPort>
	</ports>
</knimeNode>

