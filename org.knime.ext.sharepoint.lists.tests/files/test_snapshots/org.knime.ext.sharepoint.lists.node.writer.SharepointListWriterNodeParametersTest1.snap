{
  "data" : {
    "model" : {
      "site" : {
        "mode" : "ROOT",
        "webUrl" : "",
        "group" : "",
        "subsite" : {
          "displayedSubsite" : null,
          "subsite" : ""
        }
      },
      "list" : {
        "list" : {
          "checkExistenceInDialog" : false,
          "existingList" : "",
          "listMode" : "CREATE",
          "newListName" : ""
        },
        "writeMode" : {
          "writeMode" : "OVERWRITE",
          "ifListExists" : "OVERWRITE"
        }
      },
      "timeout" : {
        "connectionTimeout" : 20,
        "readTimeout" : 20
      }
    }
  },
  "schema" : {
    "type" : "object",
    "properties" : {
      "model" : {
        "type" : "object",
        "properties" : {
          "list" : {
            "type" : "object",
            "properties" : {
              "list" : {
                "type" : "object",
                "properties" : {
                  "checkExistenceInDialog" : {
                    "type" : "boolean",
                    "default" : true
                  },
                  "existingList" : {
                    "type" : "string",
                    "title" : "List",
                    "description" : "An existing SharePoint list. The drop down menu shows lists in the format &lt;display-name&gt;\n(&lt;internal-name&gt;). The display name is a user-chosen name that is editable in SharePoint,\nwhereas the internal name is fixed and auto-generated by SharePoint.\nThe node stores a unique technical ID which is used to find the list.\n",
                    "default" : ""
                  },
                  "listMode" : {
                    "oneOf" : [ {
                      "const" : "SELECT",
                      "title" : "Select"
                    }, {
                      "const" : "CREATE",
                      "title" : "Create"
                    } ],
                    "title" : "List mode",
                    "description" : "Specify whether to select an existing list or create a new one.\n\n<ul>\n<li><b>Select</b>: Select an already existing list.</li>\n<li><b>Create</b>: Use the first list with the specified display name. If\nno such list exists, create one.</li>\n</ul>",
                    "default" : "SELECT"
                  },
                  "newListName" : {
                    "type" : "string",
                    "title" : "List name",
                    "description" : "The display name of the list to use. If no such list exists, it will be created.\nThe list will be matched by its display name only. If there are\nmultiple lists with the same name, the first one returned by the API will be used, which\nmay lead to unexpected results if the list is renamed in SharePoint. Thus it is best\nto use “select” mode if the list exists or was created by a previous execution of\nthis node.\n",
                    "default" : ""
                  }
                },
                "default" : {
                  "checkExistenceInDialog" : true,
                  "existingList" : "",
                  "listMode" : "SELECT",
                  "newListName" : ""
                }
              },
              "writeMode" : {
                "type" : "object",
                "properties" : {
                  "ifListExists" : {
                    "oneOf" : [ {
                      "const" : "FAIL",
                      "title" : "Fail"
                    }, {
                      "const" : "APPEND",
                      "title" : "Append"
                    }, {
                      "const" : "OVERWRITE",
                      "title" : "Overwrite"
                    } ],
                    "title" : "If list already exists",
                    "description" : "How to handle the situation when a list with the same name already exists.\n<ul>\n<li><b>Fail</b>: Fail node execution if an list already exists.</li>\n<li><b>Append</b>: If the list already exists, the data will be appended at the bottom of the list.\nThere are limitations to appending. Please check the note in the node introduction\nfor more information.</li>\n<li><b>Overwrite</b>: Overwrite an existing list by removing all columns and items beforehand.</li>\n</ul>",
                    "default" : "FAIL"
                  },
                  "writeMode" : {
                    "oneOf" : [ {
                      "const" : "APPEND",
                      "title" : "Append"
                    }, {
                      "const" : "OVERWRITE",
                      "title" : "Overwrite"
                    } ],
                    "title" : "List write mode",
                    "description" : "How to write to the selected list.\n<ul>\n<li><b>Append</b>: Append the data at the bottom of the list.\nThere are limitations to appending. Please check the note in the node introduction\nfor more information.</li>\n<li><b>Overwrite</b>: Overwrite the list by removing all columns and items beforehand.</li>\n</ul>",
                    "default" : "APPEND"
                  }
                },
                "default" : {
                  "writeMode" : "APPEND",
                  "ifListExists" : "FAIL"
                }
              }
            },
            "default" : {
              "list" : {
                "checkExistenceInDialog" : true,
                "existingList" : "",
                "listMode" : "SELECT",
                "newListName" : ""
              },
              "writeMode" : {
                "writeMode" : "APPEND",
                "ifListExists" : "FAIL"
              }
            }
          },
          "site" : {
            "type" : "object",
            "properties" : {
              "group" : {
                "type" : "string",
                "title" : "Group",
                "description" : "The Office 365 group whose team site to connect to."
              },
              "message" : {
                "type" : "object"
              },
              "mode" : {
                "oneOf" : [ {
                  "const" : "ROOT",
                  "title" : "Root site"
                }, {
                  "const" : "WEB_URL",
                  "title" : "Web URL"
                }, {
                  "const" : "GROUP",
                  "title" : "Group site"
                } ],
                "title" : "SharePoint site",
                "description" : "Select how to specify the SharePoint site.\n<ul>\n<li><b>Root site</b>: Connect to the root site of the domain of the current user</li>\n<li><b>Web URL</b>: Specify the web URL of a SharePoint site.</li>\n<li><b>Group site</b>: Connect to the team site of a particular Office 365 group.</li>\n</ul>",
                "default" : "ROOT"
              },
              "subsite" : {
                "type" : "object",
                "properties" : {
                  "displayedSubsite" : {
                    "type" : [ "string", "null" ],
                    "title" : "Connect to subsite",
                    "description" : "A (nested) subsite of the SharePoint site specified above. If selected, the node will connect to\nthe subsite instead of the parent site. Note that access is limited to content\nof the subsite, not those of the parent site(s).\n",
                    "default" : null
                  },
                  "subsite" : {
                    "type" : "string",
                    "default" : ""
                  }
                },
                "default" : {
                  "displayedSubsite" : null,
                  "subsite" : ""
                }
              },
              "webUrl" : {
                "type" : "string",
                "title" : "URL",
                "description" : "The web URL of the SharePoint site, for example https://mycompany.sharepoint.com",
                "default" : "https://company.sharepoint.com"
              }
            },
            "default" : {
              "mode" : "ROOT",
              "webUrl" : "https://company.sharepoint.com",
              "subsite" : {
                "displayedSubsite" : null,
                "subsite" : ""
              }
            }
          },
          "timeout" : {
            "type" : "object",
            "properties" : {
              "connectionTimeout" : {
                "type" : "integer",
                "format" : "int32",
                "title" : "Connection timeout in seconds",
                "description" : "The timeout in seconds to establish a connection, or 0 for an infinite timeout.",
                "default" : 20
              },
              "readTimeout" : {
                "type" : "integer",
                "format" : "int32",
                "title" : "Read timeout in seconds",
                "description" : "The timeout in seconds to read data from an established connection, or\n0 for an infinite timeout.",
                "default" : 20
              }
            },
            "default" : {
              "connectionTimeout" : 20,
              "readTimeout" : 20
            }
          }
        }
      }
    }
  },
  "ui_schema" : {
    "elements" : [ {
      "type" : "Control",
      "id" : "#/properties/model/properties/site/properties/message",
      "options" : {
        "format" : "textMessage"
      },
      "providedOptions" : [ "message" ]
    }, {
      "label" : "SharePoint Site",
      "type" : "Section",
      "elements" : [ {
        "type" : "Control",
        "scope" : "#/properties/model/properties/site/properties/mode",
        "options" : {
          "format" : "valueSwitch"
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/site/properties/webUrl",
        "rule" : {
          "effect" : "SHOW",
          "condition" : {
            "scope" : "#/properties/model/properties/site/properties/mode",
            "schema" : {
              "oneOf" : [ {
                "const" : "WEB_URL"
              } ]
            }
          }
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/site/properties/group",
        "options" : {
          "format" : "dropDown"
        },
        "providedOptions" : [ "possibleValues" ],
        "rule" : {
          "effect" : "SHOW",
          "condition" : {
            "scope" : "#/properties/model/properties/site/properties/mode",
            "schema" : {
              "oneOf" : [ {
                "const" : "GROUP"
              } ]
            }
          }
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/site/properties/subsite/properties/displayedSubsite",
        "options" : {
          "format" : "dropDown",
          "hideOnNull" : true
        },
        "providedOptions" : [ "possibleValues", "default" ]
      } ]
    }, {
      "label" : "SharePoint List",
      "type" : "Section",
      "elements" : [ {
        "type" : "Control",
        "scope" : "#/properties/model/properties/list/properties/list/properties/listMode",
        "options" : {
          "format" : "valueSwitch"
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/list/properties/list/properties/existingList",
        "options" : {
          "format" : "dropDown"
        },
        "providedOptions" : [ "possibleValues" ],
        "rule" : {
          "effect" : "HIDE",
          "condition" : {
            "scope" : "#/properties/model/properties/list/properties/list/properties/listMode",
            "schema" : {
              "oneOf" : [ {
                "const" : "CREATE"
              } ]
            }
          }
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/list/properties/list/properties/newListName",
        "options" : {
          "validation" : {
            "pattern" : {
              "errorMessage" : "The field cannot be blank (it must contain at least one non-whitespace character).",
              "parameters" : {
                "pattern" : ".*\\S.*"
              }
            }
          }
        },
        "rule" : {
          "effect" : "SHOW",
          "condition" : {
            "scope" : "#/properties/model/properties/list/properties/list/properties/listMode",
            "schema" : {
              "oneOf" : [ {
                "const" : "CREATE"
              } ]
            }
          }
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/list/properties/writeMode/properties/writeMode",
        "options" : {
          "format" : "valueSwitch"
        },
        "rule" : {
          "effect" : "HIDE",
          "condition" : {
            "scope" : "#/properties/model/properties/list/properties/list/properties/listMode",
            "schema" : {
              "oneOf" : [ {
                "const" : "CREATE"
              } ]
            }
          }
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/list/properties/writeMode/properties/ifListExists",
        "options" : {
          "format" : "valueSwitch"
        },
        "rule" : {
          "effect" : "SHOW",
          "condition" : {
            "scope" : "#/properties/model/properties/list/properties/list/properties/listMode",
            "schema" : {
              "oneOf" : [ {
                "const" : "CREATE"
              } ]
            }
          }
        }
      } ]
    }, {
      "label" : "Timeouts",
      "type" : "Section",
      "options" : {
        "isAdvanced" : true
      },
      "elements" : [ {
        "type" : "Control",
        "scope" : "#/properties/model/properties/timeout/properties/connectionTimeout",
        "options" : {
          "validation" : {
            "max" : {
              "errorMessage" : "The value must not exceed 2147483.",
              "parameters" : {
                "isExclusive" : false,
                "max" : 2147483.0
              }
            },
            "min" : {
              "errorMessage" : "The value must be at least 0.",
              "parameters" : {
                "isExclusive" : false,
                "min" : 0.0
              }
            }
          }
        }
      }, {
        "type" : "Control",
        "scope" : "#/properties/model/properties/timeout/properties/readTimeout",
        "options" : {
          "validation" : {
            "max" : {
              "errorMessage" : "The value must not exceed 2147483.",
              "parameters" : {
                "isExclusive" : false,
                "max" : 2147483.0
              }
            },
            "min" : {
              "errorMessage" : "The value must be at least 0.",
              "parameters" : {
                "isExclusive" : false,
                "min" : 0.0
              }
            }
          }
        }
      } ]
    } ]
  },
  "persist" : {
    "type" : "object",
    "properties" : {
      "model" : {
        "type" : "object",
        "properties" : {
          "site" : {
            "type" : "object",
            "properties" : {
              "message" : { },
              "mode" : { },
              "webUrl" : {
                "deprecatedConfigKeys" : [ {
                  "deprecated" : [ [ "site" ] ]
                } ]
              },
              "group" : {
                "configPaths" : [ [ "groupId" ], [ "groupName" ] ],
                "deprecatedConfigKeys" : [ {
                  "deprecated" : [ [ "group" ] ]
                } ]
              },
              "subsite" : {
                "configPaths" : [ [ "subsiteId" ], [ "subsiteName" ], [ "connectToSubsite" ] ],
                "deprecatedConfigKeys" : [ {
                  "deprecated" : [ [ "subsite" ] ]
                } ]
              }
            }
          },
          "list" : {
            "type" : "object",
            "properties" : {
              "list" : {
                "type" : "object",
                "properties" : {
                  "checkExistenceInDialog" : {
                    "configPaths" : [ ]
                  },
                  "existingList" : {
                    "configPaths" : [ [ "listId" ], [ "listDisplayName" ], [ "listInternalName" ] ]
                  },
                  "listMode" : { },
                  "newListName" : { }
                },
                "propertiesRoute" : [ ".." ],
                "deprecatedConfigKeys" : [ {
                  "deprecated" : [ [ "list" ], [ "listName" ] ]
                } ]
              },
              "writeMode" : {
                "type" : "object",
                "properties" : {
                  "writeMode" : {
                    "deprecatedConfigKeys" : [ {
                      "deprecated" : [ ]
                    } ]
                  },
                  "ifListExists" : {
                    "deprecatedConfigKeys" : [ {
                      "deprecated" : [ ]
                    } ]
                  }
                },
                "propertiesRoute" : [ ".." ]
              }
            }
          },
          "timeout" : {
            "type" : "object",
            "properties" : {
              "connectionTimeout" : { },
              "readTimeout" : { }
            },
            "propertiesRoute" : [ ".." ]
          }
        }
      }
    }
  },
  "initialUpdates" : [ {
    "scope" : "#/properties/model/properties/list/properties/list/properties/checkExistenceInDialog",
    "values" : [ {
      "indices" : [ ],
      "value" : true
    } ]
  }, {
    "scope" : "#/properties/model/properties/site/properties/group",
    "providedOptionName" : "possibleValues",
    "values" : [ {
      "indices" : [ ],
      "value" : [ ]
    } ]
  }, {
    "scope" : "#/properties/model/properties/site/properties/subsite/properties/displayedSubsite",
    "providedOptionName" : "default",
    "values" : [ {
      "indices" : [ ],
      "value" : ""
    } ]
  }, {
    "id" : "#/properties/model/properties/site/properties/message",
    "providedOptionName" : "message",
    "values" : [ {
      "indices" : [ ],
      "value" : {
        "title" : "Credential unavailable",
        "description" : "Credential not available anymore. Please re-execute the preceding authenticator node.",
        "type" : "WARNING"
      }
    } ]
  } ],
  "globalUpdates" : [ {
    "trigger" : {
      "id" : "after-open-dialog"
    },
    "triggerInitially" : true,
    "dependencies" : [ "#/properties/model/properties/list/properties/list/properties/newListName", "#/properties/model/properties/site", "#/properties/model/properties/site/properties/group", "#/properties/model/properties/site/properties/mode", "#/properties/model/properties/site/properties/webUrl" ]
  }, {
    "trigger" : {
      "scope" : "#/properties/model/properties/list/properties/list/properties/newListName"
    },
    "dependencies" : [ "#/properties/model/properties/list/properties/list/properties/newListName", "#/properties/model/properties/site" ]
  }, {
    "trigger" : {
      "scope" : "#/properties/model/properties/site"
    },
    "dependencies" : [ "#/properties/model/properties/list/properties/list/properties/newListName", "#/properties/model/properties/site" ]
  }, {
    "trigger" : {
      "scope" : "#/properties/model/properties/site/properties/group"
    },
    "dependencies" : [ "#/properties/model/properties/site/properties/group", "#/properties/model/properties/site/properties/mode", "#/properties/model/properties/site/properties/webUrl" ]
  }, {
    "trigger" : {
      "scope" : "#/properties/model/properties/site/properties/mode"
    },
    "dependencies" : [ "#/properties/model/properties/site/properties/group", "#/properties/model/properties/site/properties/mode", "#/properties/model/properties/site/properties/webUrl" ]
  }, {
    "trigger" : {
      "scope" : "#/properties/model/properties/site/properties/subsite/properties/displayedSubsite"
    },
    "dependencies" : [ "#/properties/model/properties/site/properties/subsite/properties/displayedSubsite" ]
  }, {
    "trigger" : {
      "scope" : "#/properties/model/properties/site/properties/subsite/properties/subsite"
    },
    "dependencies" : [ "#/properties/model/properties/site/properties/subsite/properties/subsite" ]
  }, {
    "trigger" : {
      "scope" : "#/properties/model/properties/site/properties/webUrl"
    },
    "dependencies" : [ "#/properties/model/properties/site/properties/group", "#/properties/model/properties/site/properties/mode", "#/properties/model/properties/site/properties/webUrl" ]
  } ]
}